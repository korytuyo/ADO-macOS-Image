<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 900">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
    <marker id="arrowhead-red" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#DC2626"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#059669"/>
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="1200" height="900" fill="#F8FAFC"/>
  
  <!-- Title Section -->
  <rect x="0" y="0" width="1200" height="70" fill="#1E3A5F"/>
  <text x="600" y="35" text-anchor="middle" fill="white" font-family="Segoe UI, Arial" font-size="24" font-weight="bold">macOS-13 Migration Decision Tree</text>
  <text x="600" y="55" text-anchor="middle" fill="#93C5FD" font-family="Segoe UI, Arial" font-size="14">Azure DevOps Hosted Agent Retirement: December 4, 2025</text>
  
  <!-- Legend -->
  <rect x="30" y="85" width="200" height="100" rx="8" fill="white" stroke="#E5E7EB" filter="url(#shadow)"/>
  <text x="45" y="105" fill="#374151" font-family="Segoe UI, Arial" font-size="12" font-weight="bold">LEGEND</text>
  <rect x="45" y="115" width="16" height="16" rx="3" fill="#DC2626"/>
  <text x="70" y="127" fill="#374151" font-family="Segoe UI, Arial" font-size="11">Retiring / Action Required</text>
  <rect x="45" y="138" width="16" height="16" rx="3" fill="#059669"/>
  <text x="70" y="150" fill="#374151" font-family="Segoe UI, Arial" font-size="11">Recommended Target</text>
  <rect x="45" y="161" width="16" height="16" rx="3" fill="#2563EB"/>
  <text x="70" y="173" fill="#374151" font-family="Segoe UI, Arial" font-size="11">Decision Point</text>
  
  <!-- Timeline -->
  <rect x="250" y="85" width="920" height="50" rx="8" fill="#FEF3C7" stroke="#F59E0B" filter="url(#shadow)"/>
  <text x="270" y="110" fill="#92400E" font-family="Segoe UI, Arial" font-size="12" font-weight="bold">TIMELINE:</text>
  <text x="340" y="110" fill="#78350F" font-family="Segoe UI, Arial" font-size="11">Sep 1: Deprecation Started</text>
  <text x="530" y="110" fill="#78350F" font-family="Segoe UI, Arial" font-size="11">→ Nov 4-25: Brownouts</text>
  <text x="720" y="110" fill="#DC2626" font-family="Segoe UI, Arial" font-size="11" font-weight="bold">→ Dec 4: FULL RETIREMENT</text>
  <text x="940" y="110" fill="#78350F" font-family="Segoe UI, Arial" font-size="11">→ No Rollback Possible</text>
  
  <!-- Starting Point - Current State -->
  <rect x="480" y="160" width="240" height="60" rx="8" fill="#DC2626" filter="url(#shadow)"/>
  <text x="600" y="185" text-anchor="middle" fill="white" font-family="Segoe UI, Arial" font-size="14" font-weight="bold">Pipeline Using macOS-13</text>
  <text x="600" y="205" text-anchor="middle" fill="#FEE2E2" font-family="Segoe UI, Arial" font-size="11">vmImage: 'macos-13'</text>
  
  <!-- Arrow down to first decision -->
  <line x1="600" y1="220" x2="600" y2="260" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Decision 1: Agent Type -->
  <polygon points="600,270 700,320 600,370 500,320" fill="#2563EB" filter="url(#shadow)"/>
  <text x="600" y="315" text-anchor="middle" fill="white" font-family="Segoe UI, Arial" font-size="12" font-weight="bold">Agent Type?</text>
  <text x="600" y="332" text-anchor="middle" fill="#DBEAFE" font-family="Segoe UI, Arial" font-size="10">Microsoft-Hosted</text>
  
  <!-- Self-hosted branch (No action needed) -->
  <line x1="700" y1="320" x2="850" y2="320" stroke="#059669" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <text x="775" y="310" text-anchor="middle" fill="#374151" font-family="Segoe UI, Arial" font-size="10">Self-Hosted/VMSS</text>
  
  <rect x="860" y="290" width="180" height="60" rx="8" fill="#059669" filter="url(#shadow)"/>
  <text x="950" y="315" text-anchor="middle" fill="white" font-family="Segoe UI, Arial" font-size="12" font-weight="bold">No Action Required</text>
  <text x="950" y="332" text-anchor="middle" fill="#D1FAE5" font-family="Segoe UI, Arial" font-size="10">Not affected by retirement</text>
  
  <!-- Microsoft-hosted branch continues -->
  <line x1="600" y1="370" x2="600" y2="410" stroke="#374151" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="615" y="395" fill="#374151" font-family="Segoe UI, Arial" font-size="10">MS-Hosted</text>
  
  <!-- Decision 2: Xcode Requirements -->
  <polygon points="600,420 720,480 600,540 480,480" fill="#2563EB" filter="url(#shadow)"/>
  <text x="600" y="470" text-anchor="middle" fill="white" font-family="Segoe UI, Arial" font-size="12" font-weight="bold">Xcode Version</text>
  <text x="600" y="487" text-anchor="middle" fill="#DBEAFE" font-family="Segoe UI, Arial" font-size="10">Requirements?</text>
  <text x="600" y="502" text-anchor="middle" fill="#DBEAFE" font-family="Segoe UI, Arial" font-size="9">(Check iOS SDK needs)</text>
  
  <!-- Xcode 16.3+ branch - macOS-15 -->
  <line x1="720" y1="480" x2="900" y2="480" stroke="#059669" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <text x="810" y="470" text-anchor="middle" fill="#374151" font-family="Segoe UI, Arial" font-size="10">Xcode 16.3+</text>
  
  <rect x="910" y="440" width="200" height="80" rx="8" fill="#059669" filter="url(#shadow)"/>
  <text x="1010" y="465" text-anchor="middle" fill="white" font-family="Segoe UI, Arial" font-size="14" font-weight="bold">Use macOS-15</text>
  <text x="1010" y="485" text-anchor="middle" fill="#D1FAE5" font-family="Segoe UI, Arial" font-size="11">vmImage: 'macos-15'</text>
  <text x="1010" y="502" text-anchor="middle" fill="#D1FAE5" font-family="Segoe UI, Arial" font-size="9">Latest features + ARM support</text>
  
  <!-- Xcode 15.x or lower - macOS-14 -->
  <line x1="600" y1="540" x2="600" y2="590" stroke="#059669" stroke-width="2" marker-end="url(#arrowhead-green)"/>
  <text x="530" y="570" fill="#374151" font-family="Segoe UI, Arial" font-size="10">Xcode 14.3 - 15.4</text>
  
  <rect x="500" y="600" width="200" height="80" rx="8" fill="#059669" filter="url(#shadow)"/>
  <text x="600" y="625" text-anchor="middle" fill="white" font-family="Segoe UI, Arial" font-size="14" font-weight="bold">Use macOS-14</text>
  <text x="600" y="645" text-anchor="middle" fill="#D1FAE5" font-family="Segoe UI, Arial" font-size="11">vmImage: 'macos-14'</text>
  <text x="600" y="662" text-anchor="middle" fill="#D1FAE5" font-family="Segoe UI, Arial" font-size="9">or 'macos-latest'</text>
  
  <!-- Older Xcode branch -->
  <line x1="480" y1="480" x2="280" y2="480" stroke="#DC2626" stroke-width="2" marker-end="url(#arrowhead-red)"/>
  <text x="380" y="470" text-anchor="middle" fill="#374151" font-family="Segoe UI, Arial" font-size="10">Xcode &lt; 14.3</text>
  
  <rect x="80" y="440" width="200" height="80" rx="8" fill="#FEF3C7" stroke="#F59E0B" filter="url(#shadow)"/>
  <text x="180" y="465" text-anchor="middle" fill="#92400E" font-family="Segoe UI, Arial" font-size="12" font-weight="bold">Upgrade Required</text>
  <text x="180" y="485" text-anchor="middle" fill="#78350F" font-family="Segoe UI, Arial" font-size="10">Update project to newer</text>
  <text x="180" y="500" text-anchor="middle" fill="#78350F" font-family="Segoe UI, Arial" font-size="10">Xcode/iOS SDK first</text>
  
  <!-- Implementation Steps Box -->
  <rect x="80" y="570" width="320" height="200" rx="8" fill="white" stroke="#E5E7EB" filter="url(#shadow)"/>
  <rect x="80" y="570" width="320" height="30" rx="8" fill="#1E3A5F"/>
  <text x="100" y="590" fill="white" font-family="Segoe UI, Arial" font-size="12" font-weight="bold">IMPLEMENTATION STEPS</text>
  
  <text x="100" y="620" fill="#374151" font-family="Segoe UI, Arial" font-size="11" font-weight="bold">1. Update YAML</text>
  <text x="115" y="638" fill="#6B7280" font-family="Segoe UI, Arial" font-size="10">vmImage: 'macos-13' → 'macos-14'</text>
  
  <text x="100" y="660" fill="#374151" font-family="Segoe UI, Arial" font-size="11" font-weight="bold">2. Set Xcode Version (if needed)</text>
  <text x="115" y="678" fill="#6B7280" font-family="Segoe UI, Arial" font-size="10">- task: UseXcode@6</text>
  
  <text x="100" y="700" fill="#374151" font-family="Segoe UI, Arial" font-size="11" font-weight="bold">3. Test Pipeline</text>
  <text x="115" y="718" fill="#6B7280" font-family="Segoe UI, Arial" font-size="10">Run on feature branch before merge</text>
  
  <text x="100" y="740" fill="#374151" font-family="Segoe UI, Arial" font-size="11" font-weight="bold">4. Validate Artifacts</text>
  <text x="115" y="758" fill="#6B7280" font-family="Segoe UI, Arial" font-size="10">Check signing, IPA generation, tests</text>
  
  <!-- What's on Each Image Box -->
  <rect x="800" y="570" width="350" height="200" rx="8" fill="white" stroke="#E5E7EB" filter="url(#shadow)"/>
  <rect x="800" y="570" width="350" height="30" rx="8" fill="#1E3A5F"/>
  <text x="820" y="590" fill="white" font-family="Segoe UI, Arial" font-size="12" font-weight="bold">IMAGE COMPARISON</text>
  
  <text x="820" y="620" fill="#059669" font-family="Segoe UI, Arial" font-size="11" font-weight="bold">macOS-14 (Sonoma)</text>
  <text x="835" y="638" fill="#6B7280" font-family="Segoe UI, Arial" font-size="10">• Xcode 14.3 - 15.4 available</text>
  <text x="835" y="653" fill="#6B7280" font-family="Segoe UI, Arial" font-size="10">• Intel-based (x64)</text>
  <text x="835" y="668" fill="#6B7280" font-family="Segoe UI, Arial" font-size="10">• Current 'macos-latest' target</text>
  
  <text x="820" y="695" fill="#059669" font-family="Segoe UI, Arial" font-size="11" font-weight="bold">macOS-15 (Sequoia)</text>
  <text x="835" y="713" fill="#6B7280" font-family="Segoe UI, Arial" font-size="10">• Xcode 16.0+ required</text>
  <text x="835" y="728" fill="#6B7280" font-family="Segoe UI, Arial" font-size="10">• ARM64 preview available</text>
  <text x="835" y="743" fill="#6B7280" font-family="Segoe UI, Arial" font-size="10">• Latest platform SDKs</text>
  <text x="835" y="758" fill="#DC2626" font-family="Segoe UI, Arial" font-size="10">• Breaks iOS &lt; Xcode 16.3 compat</text>
  
  <!-- Footer -->
  <rect x="0" y="830" width="1200" height="70" fill="#F1F5F9"/>
  <text x="600" y="855" text-anchor="middle" fill="#64748B" font-family="Segoe UI, Arial" font-size="11">Reference: https://learn.microsoft.com/en-us/azure/devops/pipelines/agents/hosted</text>
  <text x="600" y="875" text-anchor="middle" fill="#64748B" font-family="Segoe UI, Arial" font-size="11">Deprecation Blog: https://devblogs.microsoft.com/devops/upcoming-updates-for-azure-pipelines-agents-images/</text>
</svg>
